{
    "contents" : "source('speech-head.R')\nlibrary(plyr)\nfile.speech_text <- 'D:\\\\Personal\\\\PhD\\\\Speech to text\\\\speech-text-data\\\\Speech-text data - English.tsv'\ndata.speech_text <- read.delim(file.speech_text, quote=\"\", stringsAsFactors=F)\ndata.speech_text <- as.data.frame(sapply(data.speech_text, function(x) gsub(\"[[:punct:]]\", \"\", x)), stringsAsFactors=F)\ndata.speech_text <- as.data.frame(sapply(data.speech_text, tolower), stringsAsFactors=F)\n\ncounter <- function(data.row) {\n  data.actual       <- data.row[1,1]\n  data.actual.words <- strsplit(data.actual, \" \")[[1]]\n  data.frame(lapply(data.row[1,-1], function(x) sum(data.actual.words %in% strsplit(x, \" \")[[1]])))\n}\n\nhowmany <- function(word, row) {\n  sum(unlist(lapply(strsplit(row, \" \"), function(x) word %in% x)))\n}\n\ncounter2 <- function(data.row) {\n  data.actual       <- data.row[1,1]\n  data.actual.words <- strsplit(data.actual, \" \")[[1]]\n  result.df <- as.data.frame(lapply(data.actual.words, howmany, as.character(data.row[1,-1])))\n  colnames(result.df)=data.actual.words\n  return(result.df)\n}\n\ncount.word <- adply(data.speech_text, 1, counter)\n#*********How many users got a word right?**********\nfor(i in 1:25) {\n  count.users <- adply(data.speech_text[i,], 1, counter2, .expand=F)\n  write.table(count.users, file='count.users', append=T, quote=F, row.names=F, sep=\",\")\n}\n######################################################\nlibrary(ngram)\nhowmany_ngram <- function(word, row, n=1) {\n#  print(word)\n#  sum(unlist(lapply(row, function(x) grepl(word, x))))\n  result <- sum(unlist(lapply(row, function(x) grepl(word, x))))/length(row)*100\n  trunc(result)\n}\n\ncounter_ngram <- function(data.row, n=1) {\n  data.actual       <- data.row[1,1]\n  ng                <- ngram(data.actual, n=n)\n  data.actual.words <- get.ngrams(ng)\n  result.df <- as.data.frame(lapply(data.actual.words, howmany_ngram, data.row[, -1], n))\n  colnames(result.df)=data.actual.words\n  return(result.df)\n}\nfor(i in 1:25) {\n#  count.users <- counter_ngram(data.speech_text[i,], n=2)\n  count.users <- adply(data.speech_text[i,], 1, counter_ngram, n=2, .expand=F)\n#  print(count.users)\n  write.table(count.users, file='count.users.per.2', append=T, quote=F, row.names=F, sep=\",\")\n}\n##########################################################\nlibrary(readr)\nlibrary(dplyr)\nfor(i in 1:5){\n  data.all   <- read_lines(paste0('count.users.per.',i))\n  data.all.p <- data.all[c(TRUE,FALSE)]\n  data.all.c <- data.all[c(FALSE,TRUE)]\n  df         <- data.frame(p=unlist(lapply(data.all.p, strsplit, ',')), \n                         c=unlist(lapply(data.all.c, strsplit, ',')), stringsAsFactors=F) %>% \n    mutate_each(funs(as.numeric), c) %>%\n    arrange(c)\n  write.csv(df, paste0('df.per.',i), quote=F, row.names=F)\n}\n##########################################################\nlibrary(ggplot2)\nlibrary(grid)\nlibrary(gridExtra)\nplots <- list()\n\ndf <- read.csv(paste0('df.per.1'), stringsAsFactors=F)\nqplot(df$c, geom='histogram', main='1-gram', xlab='% Speakers', ylab='#1-grams', binwidth=.4)\n\ndf <- read.csv(paste0('df.per.2'), stringsAsFactors=F)\nqplot(df$c, geom='histogram', main='2-gram', xlab='% Speakers', ylab='#2-grams', binwidth=.4)  \n\ndf <- read.csv(paste0('df.per.3'), stringsAsFactors=F)\nqplot(df$c, geom='histogram', main='3-gram', xlab='% Speakers', ylab='#3-grams', binwidth=.4)  \n\ndf <- read.csv(paste0('df.per.4'), stringsAsFactors=F)\nqplot(df$c, geom='histogram', main='4-gram', xlab='% Speakers', ylab='#4-grams', binwidth=.4)  \n\ndf <- read.csv(paste0('df.per.5'), stringsAsFactors=F)\nqplot(df$c, geom='histogram', main='5-gram', xlab='% Speakers', ylab='#5-grams', binwidth=.4)  \n\nmultiplot(plotlist = plots, cols = 2)\n#plots <- lapply(count.word[,-1], function(x) qplot(as.numeric(x), geom='histogram', ylim=c(0,20)))\n#grid.arrange(plots, ncol=2)\nqplot(as.numeric(count.word[1, -1]), geom='histogram', ylim=c(0,20))\n",
    "created" : 1436863744202.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "3190569871",
    "id" : "DA248C7E",
    "lastKnownWriteTime" : 1437559129,
    "path" : "C:/Users/akulkarni/RWorkspace/speech-text/speech-text.R",
    "project_path" : "speech-text.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "source_on_save" : false,
    "type" : "r_source"
}